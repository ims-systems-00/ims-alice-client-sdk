var e=require("axios"),t=require("moment");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=/*#__PURE__*/r(e),o=/*#__PURE__*/r(t),i=n.default.create({withCredentials:!0}),s={config:function(e){i.defaults.baseURL=(null==e?void 0:e.baseURL)||"https://https://alice-server-prod.imssystems.tech/api/v1"},instance:i,get:i.get,post:i.post,put:i.put,patch:i.patch,delete:i.delete,setJwt:function(e,t){i.defaults.headers.common["x-auth-accesstoken"]=""+e,i.defaults.headers.common["x-auth-refreshtoken"]=""+t},HTTPError:e.AxiosError},a=function(e){try{return Promise.resolve(s.post(u+"/auth/login",{email:e.email,password:e.password}))}catch(e){return Promise.reject(e)}},u="/accounts";function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c.apply(this,arguments)}var d="/users";function l(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function f(e,t,r){if(!e.s){if(r instanceof h){if(!r.s)return void(r.o=f.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(f.bind(null,e,t),f.bind(null,e,2));e.s=t,e.v=r;var n=e.o;n&&n(e)}}var h=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(t,r){var n=new e,o=this.s;if(o){var i=1&o?t:r;if(i){try{f(n,1,i(this.v))}catch(e){f(n,2,e)}return n}return this}return this.o=function(e){try{var o=e.v;1&e.s?f(n,1,t?t(o):o):r?f(n,1,r(o)):f(n,2,o)}catch(e){f(n,2,e)}},n},e}();function p(e){return e instanceof h&&1&e.s}var v="/conversation",m={role:"system",content:"You are an AI assistant named Alice. Always generate all your response in a markdown (don't wrap in code blocks only wrap in codeblock if it's some code or diagram) format. \n  Always comprehend your answers when asked for any documentation or policies. Make sure you give \n  language name in codeblocks markdown and never miss it. If you are asked to make or build \n  or prepare or construct charts or diagrams use mermaid js syntex for the charts and diagrams \n  and always include it codeblock markdown. Also try to explain or comprehend your general \n  answers with details as much as possible. Use UK english in your reseponses."},y="/chats",g="/chatheads";function P(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var x="/file-manager";o.default().format(),exports.createChat=function(e){return s.post(y+"/",{chathead:e.chathead,prompt:e.prompt,response:e.response})},exports.createChatead=function(e){return s.post(g+"/",{name:e.name,description:e.description||""})},exports.downloadFile=function(e){try{var t=P(function(){var t,r=(null==e?void 0:e.Name)||(null==e||null==(t=e.Key)?void 0:t.split("/")[1]);return Promise.resolve(s.get(x+"/signed-url",{headers:{"x-file-name":r,"x-file-key":(null==e?void 0:e.Key)||(null==e?void 0:e.key),"x-file-version":null,"x-file-bucket":null==e?void 0:e.Bucket}})).then(function(e){var t=e.data,n=document.createElement("a");n.href=t.url,n.target="_blank",n.rel="noopener",n.setAttribute("download",r),document.body.appendChild(n),n.click(),n.remove()})},function(){});return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},exports.downloader=function(e,t){var r=window.URL.createObjectURL(new Blob([t])),n=document.createElement("a");n.href=r,n.setAttribute("download",e),document.body.appendChild(n),n.click(),n.remove()},exports.getChat=function(e){return s.get(y+"/"+e)},exports.getChatead=function(e){return s.get(g+"/"+e)},exports.getUserInfo=function(e){return s.get(d+"/"+e)},exports.hardDeleteChat=function(e){return s.delete(y+"/"+e+"/hard")},exports.hardDeleteChatead=function(e){return s.delete(g+"/"+e+"/hard")},exports.http=s,exports.listChateads=function(e){return s.get(g+"/?"+(e||""))},exports.listChats=function(e){return s.get(y+"/?"+(e||""))},exports.login=a,exports.logout=function(){try{return Promise.resolve(s.delete(u+"/auth/logout"))}catch(e){return Promise.reject(e)}},exports.normalResponse=function(e){try{return Promise.resolve(s.post(v+"/gpt-normal",{systemInstructions:e.systemInstructions||[m],conversation:e.conversation,prompt:e.prompt}))}catch(e){return Promise.reject(e)}},exports.reactOnChat=function(e,t){return s.put(y+"/"+e+"/reactions",{reaction:t.reaction})},exports.recoverAccount=function(e){try{return void 0===e&&(e={email:email}),Promise.resolve(s.post(u+"/recovery",{email:e.email}))}catch(e){return Promise.reject(e)}},exports.refreshToken=function(e){try{return Promise.resolve(s.get(u+"/auth/refresh-token"))}catch(e){return Promise.reject(e)}},exports.registerAccount=function(e){try{return void 0===e&&(e={email:email,name:name,password:password}),Promise.resolve(s.post(u+"/registration",{name:e.name,email:e.email,password:e.password})).then(function(){return a(e)})}catch(e){return Promise.reject(e)}},exports.resendVerification=function(e){try{return void 0===e&&(e={userId:userId}),Promise.resolve(s.post(u+"/registration/verification/emails",{userId:e.userId}))}catch(e){return Promise.reject(e)}},exports.streamResponse=function(e,t){void 0===t&&(t={onStream:function(){},onStreamEnd:function(){},onError:function(){},onTokenRefreshNeed:function(){return Promise.resolve()},headers:{}});try{var r=function(e){try{var r,n=function(){var e;null==(e=t)||e.onStreamEnd(i)},o=e.body.getReader(),i="",s=function(e,t,r){for(var n;;){var o=e();if(p(o)&&(o=o.v),!o)return i;if(o.then){n=0;break}var i=r();if(i&&i.then){if(!p(i)){n=1;break}i=i.s}if(t){var s=t();if(s&&s.then&&!p(s)){n=2;break}}}var a=new h,u=f.bind(null,a,2);return(0===n?o.then(d):1===n?i.then(c):s.then(l)).then(void 0,u),a;function c(n){i=n;do{if(t&&(s=t())&&s.then&&!p(s))return void s.then(l).then(void 0,u);if(!(o=e())||p(o)&&!o.v)return void f(a,1,i);if(o.then)return void o.then(d).then(void 0,u);p(i=r())&&(i=i.v)}while(!i||!i.then);i.then(c).then(void 0,u)}function d(e){e?(i=r())&&i.then?i.then(c).then(void 0,u):c(i):f(a,1,i)}function l(){(o=e())?o.then?o.then(d).then(void 0,u):d(o):f(a,1,i)}}(function(){return!r},void 0,function(){var e=l(function(){return Promise.resolve(o.read()).then(function(e){var n,o=e.value;if(e.done)r=1;else{var s=new TextDecoder("utf-8").decode(o);i+=s,null==(n=t)||n.onStream(s)}})},function(e){console.log(e)});if(e&&e.then)return e.then(function(){})});return Promise.resolve(s&&s.then?s.then(n):n())}catch(e){return Promise.reject(e)}};console.log("sending charecters:",e.conversation.reduce(function(e,t){return t.content+e},"").length),console.log("sending charecters trim:",e.conversation.reduce(function(e,t){return t.content+e.trim()},"").length);var n=l(function(){var n,o=process.env.REACT_APP_API_URL+process.env.REACT_APP_API_VERSION+(v+"/gpt-stream"),i={method:"POST",headers:c({"Content-Type":"application/json"},(null==(n=t)?void 0:n.headers)||{}),credentials:"include",body:JSON.stringify({systemInstructions:e.systemInstructions||[m],conversation:e.conversation,prompt:e.prompt})};return Promise.resolve(fetch(o,i)).then(function(e){var n=function(){if(e.ok)r(e);else{var n=function(){var n;if(401===e.status)return Promise.resolve(null==(n=t)?void 0:n.onTokenRefreshNeed()).then(function(e){var n=null==e?void 0:e.tokenPair,s=l(function(){return Promise.resolve(fetch(o,c({},i,{headers:c({},i.headers,{"x-auth-accesstoken":null==n?void 0:n.accessToken})}))).then(function(e){e.ok&&r(e)})},function(e){var r;null==(r=t)||r.onError(e)});if(s&&s.then)return s.then(function(){})})}();if(n&&n.then)return n.then(function(){})}}();if(n&&n.then)return n.then(function(){})})},function(e){var r;null==(r=t)||r.onError(e)});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},exports.updateChat=function(e,t){return s.put(y+"/"+e+"/",{name:t.name,description:t.description})},exports.updateChathead=function(e,t){return s.put(g+"/"+e+"/",{name:t.name,description:t.description})},exports.updateUserActivityStatus=function(e,t){return s.put(d+"/"+e+"/activity-status",c({},t))},exports.updateUserPassword=function(e,t){return s.post(d+"/"+e+"/change-password",{oldPassword:t.oldPassword,password:t.password})},exports.updateUserProfile=function(e,t){return s.put(d+"/"+e,{name:t.name,organisationName:t.organisationName,jobTitle:t.jobTitle})},exports.updateUserProfileImage=function(e,t){return s.put(d+"/"+e+"/profile-image",c({},t))},exports.uploadFileToS3=function(e,t){try{return Promise.resolve(P(function(){return Promise.resolve(s.get(x+"/upload-url",{headers:{"x-file-name":e.name}})).then(function(r){var n,o=r.data;return Promise.resolve(s.put(null==o||null==(n=o.details)?void 0:n.uploadUrl,e,t)).then(function(e){return e.data=c({},o),e})})},function(e){console.log(e)}))}catch(e){return Promise.reject(e)}},exports.verifyRecovery=function(e){try{return void 0===e&&(e={password:password,token:token}),Promise.resolve(s.post(u+"/recovery/verification",{password:e.password},{headers:{"x-recovery-token":e.token}}))}catch(e){return Promise.reject(e)}},exports.verifyRegistration=function(e){var t=e.token;try{return Promise.resolve(s.post(u+"/registration/verification",{},{headers:{"x-register-token":t}}))}catch(e){return Promise.reject(e)}};
//# sourceMappingURL=index.js.map
