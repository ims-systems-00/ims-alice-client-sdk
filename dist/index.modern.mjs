import e,{AxiosError as n}from"axios";import t from"moment";const o=e.create({withCredentials:!0});let r={config:function(e){o.defaults.baseURL=(null==e?void 0:e.baseURL)||"https://https://alice-server-prod.imssystems.tech/api/v1"},instance:o,get:o.get,post:o.post,put:o.put,patch:o.patch,delete:o.delete,setJwt:function(e,n){o.defaults.headers.common["x-auth-accesstoken"]=`${e}`,o.defaults.headers.common["x-auth-refreshtoken"]=`${n}`},HTTPError:n};const a="/accounts";async function s(e){return r.post(a+"/auth/login",{email:e.email,password:e.password})}async function i(e={email,name,password}){return await r.post(a+"/registration",{name:e.name,email:e.email,password:e.password}),s(e)}async function c({token:e}){return r.post(a+"/registration/verification",{},{headers:{"x-register-token":e}})}async function u(e={userId}){return r.post(a+"/registration/verification/emails",{userId:e.userId})}async function l(e={email}){return r.post(a+"/recovery",{email:e.email})}async function d(e={password,token}){return r.post(a+"/recovery/verification",{password:e.password},{headers:{"x-recovery-token":e.token}})}async function p(e){return r.get(a+"/auth/refresh-token")}async function m(){return r.delete(a+"/auth/logout")}function f(){return f=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},f.apply(this,arguments)}const h="/users";function y(e){return r.get(`${h}/${e}`)}function g(e,n){return r.put(`${h}/${e}`,{name:n.name,organisationName:n.organisationName,jobTitle:n.jobTitle})}function w(e,n){return r.put(`${h}/${e}/profile-image`,f({},n))}function v(e,n){return r.put(`${h}/${e}/activity-status`,f({},n))}function $(e,n){return r.post(`${h}/${e}/change-password`,{oldPassword:n.oldPassword,password:n.password})}const k="/conversation",b={role:"system",content:"You are an AI assistant named Alice. Always generate all your response in a markdown (don't wrap in code blocks only wrap in codeblock if it's some code or diagram) format. \n  Always comprehend your answers when asked for any documentation or policies. Make sure you give \n  language name in codeblocks markdown and never miss it. If you are asked to make or build \n  or prepare or construct charts or diagrams use mermaid js syntex for the charts and diagrams \n  and always include it codeblock markdown. Also try to explain or comprehend your general \n  answers with details as much as possible. Use UK english in your reseponses."};async function x(e,n={onStream:function(){},onStreamEnd:function(){},onError:function(){},onTokenRefreshNeed:async function(){},headers:{}}){async function t(e){const t=e.body.getReader();let o="";for(;;)try{const{value:e,done:r}=await t.read();if(r)break;const a=new TextDecoder("utf-8").decode(e);o+=a,null==n||n.onStream(a)}catch(e){console.log(e)}null==n||n.onStreamEnd(o)}console.log("sending charecters:",e.conversation.reduce((e,n)=>n.content+e,"").length),console.log("sending charecters trim:",e.conversation.reduce((e,n)=>n.content+e.trim(),"").length);try{const o=process.env.REACT_APP_API_URL+process.env.REACT_APP_API_VERSION+`${k}/gpt-stream`,r={method:"POST",headers:f({"Content-Type":"application/json"},(null==n?void 0:n.headers)||{}),credentials:"include",body:JSON.stringify({systemInstructions:e.systemInstructions||[b],conversation:e.conversation,prompt:e.prompt})},a=await fetch(o,r);if(a.ok)t(a);else if(401===a.status){const e=await(null==n?void 0:n.onTokenRefreshNeed()),a=null==e?void 0:e.tokenPair;try{let e=await fetch(o,f({},r,{headers:f({},r.headers,{"x-auth-accesstoken":null==a?void 0:a.accessToken})}));e.ok&&t(e)}catch(e){null==n||n.onError(e)}}}catch(e){null==n||n.onError(e)}}async function A(e){return r.post(`${k}/gpt-normal`,{systemInstructions:e.systemInstructions||[b],conversation:e.conversation,prompt:e.prompt})}const I="/chats";function P(e){return r.post(`${I}/`,{chathead:e.chathead,prompt:e.prompt,response:e.response})}function T(e,n){return r.put(`${I}/${e}/`,{name:n.name,description:n.description})}function E(e,n){return r.put(`${I}/${e}/reactions`,{reaction:n.reaction})}function R(e){return r.get(`${I}/?${e||""}`)}function j(e){return r.get(`${I}/${e}`)}function O(e){return r.delete(`${I}/${e}/hard`)}const U="/chatheads";function N(e){return r.post(`${U}/`,{name:e.name,description:e.description||""})}function S(e,n){return r.put(`${U}/${e}/`,{name:n.name,description:n.description})}function _(e){return r.get(`${U}/?${e||""}`)}function C(e){return r.get(`${U}/${e}`)}function L(e){return r.delete(`${U}/${e}/hard`)}const K="/file-manager";function B(e,n){const t=window.URL.createObjectURL(new Blob([n])),o=document.createElement("a");o.href=t,o.setAttribute("download",e),document.body.appendChild(o),o.click(),o.remove()}async function J(e,n){try{var t;let{data:o}=await r.get(`${K}/upload-url`,{headers:{"x-file-name":e.name}}),a=await r.put(null==o||null==(t=o.details)?void 0:t.uploadUrl,e,n);return a.data=f({},o),a}catch(e){console.log(e)}}async function D(e){try{var n;const t=(null==e?void 0:e.Name)||(null==e||null==(n=e.Key)?void 0:n.split("/")[1]),{data:o}=await r.get(`${K}/signed-url`,{headers:{"x-file-name":t,"x-file-key":(null==e?void 0:e.Key)||(null==e?void 0:e.key),"x-file-version":null,"x-file-bucket":null==e?void 0:e.Bucket}}),a=document.createElement("a");a.href=o.url,a.target="_blank",a.rel="noopener",a.setAttribute("download",t),document.body.appendChild(a),a.click(),a.remove()}catch(e){}}t().format();export{P as createChat,N as createChatead,D as downloadFile,B as downloader,j as getChat,C as getChatead,y as getUserInfo,O as hardDeleteChat,L as hardDeleteChatead,_ as listChateads,R as listChats,s as login,m as logout,A as normalResponse,E as reactOnChat,l as recoverAccount,p as refreshToken,i as registerAccount,u as resendVerification,x as streamResponse,T as updateChat,S as updateChathead,v as updateUserActivityStatus,$ as updateUserPassword,g as updateUserProfile,w as updateUserProfileImage,J as uploadFileToS3,d as verifyRecovery,c as verifyRegistration};
//# sourceMappingURL=index.modern.mjs.map
